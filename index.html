<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>PREP Pipeline: EEG-Clean-Tools by VisLab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">PREP Pipeline: EEG-Clean-Tools</h1>
      <h2 class="project-tagline">Contains tools for EEG standardized preprocessing</h2>
      <a href="https://github.com/VisLab/EEG-Clean-Tools" class="btn">View on GitHub</a>
      <a href="https://github.com/VisLab/EEG-Clean-Tools/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/VisLab/EEG-Clean-Tools/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="introduction-to-the-prep-pipeline" class="anchor" href="#introduction-to-the-prep-pipeline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction to the PREP pipeline</h1>

<p>The PREP pipeline is a standardized early-stage EEG processing pipeline that focuses on the identification of bad channels and the calculation of a robust average reference. PREP also has an extensive reporting facility. It is designed to be run in a completely automated way. The major sections of this document are:</p>

<ul>
<li>Introduction (requirements, citing, installation)</li>
<li>Algorithm (steps, meaning of parameters for each step)</li>
<li>Running as an EEGLAB plug-in</li>
<li>Running as a script</li>
</ul>

<h3>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h3>

<p>The PREP pipeline relies on the MATLAB Signal Processing toolbox and EEGLAB, a freely-available MATLAB toolbox for processing EEG. EEG is available from  <a href="http://scn.ucsd.edu/eeglab">http://scn.ucsd.edu/eeglab</a>. PREP assumes that the EEG data is provided as an EEGLAB EEG structure and that channel locations are provided in the EEG.chanlocs structure.</p>

<h3>
<a id="citing-the-prep-pipeline" class="anchor" href="#citing-the-prep-pipeline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Citing the PREP pipeline</h3>

<p>The PREP pipeline is freely available under the GUN General Public License. 
Please cite the following publication if using:  </p>

<blockquote>
<p>Bigdely-Shamlo N, Mullen T, Kothe C, Su K-M and Robbins KA (2015)<br>
The PREP pipeline: standardized preprocessing for large-scale EEG analysis<br>
Front. Neuroinform. 9:16. doi: 10.3389/fninf.2015.00016  </p>
</blockquote>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>The PREP pipeline can be run in two ways --- as a standalone toolbox or as an EEGLAB plugin. To run in standalone mode, simply download the PREP code, found the the EEG-Clean-Tools</p>

<h1>
<a id="prep-overview" class="anchor" href="#prep-overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>PREP Overview</h1>

<p>This section discusses the algorithm and the meeting of the various parameters.</p>

<h3>
<a id="processing-steps" class="anchor" href="#processing-steps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Processing steps</h3>

<ol>
<li>Handle boundary events prior to processing</li>
<li>Detrend temporarily to properly compute thresholds</li>
<li>Remove line-noise without committing to a filtering strategy</li>
<li>Robustly reference the signal relative to an estimate of the “true” average reference</li>
<li>Detect and interpolate bad channels relative to this reference</li>
<li>Produce reports if desired</li>
<li>Post process if desired</li>
</ol>

<h2>
<a id="boundary-event-handling" class="anchor" href="#boundary-event-handling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Boundary event handling</h2>

<h2>
<a id="detrend-high-pass-filtering" class="anchor" href="#detrend-high-pass-filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Detrend (high pass filtering)</h2>

<h2>
<a id="line-noise-removal" class="anchor" href="#line-noise-removal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Line noise removal</h2>

<p>We use an iterative version of the a method that estimates the amplitude and size of a deterministic sinusoid at a specified frequency embedded in locally white noise. The model is applied in sliding windows to adjust for non stationarity. The deterministic frequencies to be removed must be specified to within a small range. By default, the line noise removal (<code>cleanLineNoise</code>) attempts to removal multiples of 60 Hz. You might need to rerun with different frequencies if unusual spectral peaks are visible in the reports. </p>

<h3>
<a id="calling-sequence-for-line-noise-removal" class="anchor" href="#calling-sequence-for-line-noise-removal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Calling sequence for line noise removal</h3>

<p>The cleanLineNoise function takes two structures in and produces two output structures. The signal structure
includes a .data field and an .srate field. The signal structure is compatible with an EEGLAB EEG structure, but does not rely on any of the other EEGLAB fields. The data field should be channels x frames. </p>

<p>As with all functions in the pipeline, the algorithm parameters are passed in a structure.  </p>

<blockquote>
<p><code>[signal, lineNoiseOut] = cleanLineNoise(signal, lineNoiseIn)</code><br>
<code>[signal, lineNoiseOut] = cleanLineNoise(signal)</code>  </p>
</blockquote>

<p>The output structure contains all of the input structure fields plus additional fields containing information on the
tapers used to compute the spectral components.</p>

<p><strong>Example:</strong>  </p>

<blockquote>
<p><code>lineNoiseIn = struct('lineNoiseChannels', [1:32, 40:60], 'lineFrequencies', [60, 120, 180, 212, 240]);</code>  </p>
</blockquote>

<h3>
<a id="parameters-for-line-noise-removal" class="anchor" href="#parameters-for-line-noise-removal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parameters for line noise removal</h3>

<p>The following parameters appear as fields in the structure that </p>

<p><strong><code>lineNoiseChannels</code></strong><br>
 A row vector specifying the channel numbers of the channels to remove line noise from.  By default, PREP uses all of the channels (<code>1:size(signal.data, 1)</code>).  </p>

<p><strong><code>Fs'</code></strong><br>
The sampling rate of the signal in Hz. By default, PREP uses the sampling rate specified in <code>signal.srate</code>.  </p>

<pre><code>              getRules(lineFrequencies, {'numeric'}, ...
               {'row', 'positive'}, ...
               'Vector of frequencies of the line noise peaks to remove.'), ...
            'p', ...
               getRules(0.01,  ...
               {'numeric'}, {'positive', 'scalar', '&lt;', 1}, ...
               'Significance cutoff level.'),  ...
            'fScanBandWidth', ...
               getRules(2,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               ['Half of the width of the frequency band centered ' ...
                'on each line frequency.']),  ...
            'taperBandWidth', ...
               getRules(2,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               'Bandwidth in Hz for the tapers.'),  ...   
            'taperWindowSize', ...
               getRules(4,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               'Taper sliding window length in seconds.'),  ...
             'taperWindowStep', ...
               getRules(1,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               'Taper sliding window step size in seconds. '),  ...
             'tau', ...
               getRules(100,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               'Window overlap smoothing factor.'),  ...
             'pad', ...
               getRules(0,  ...
               {'numeric'}, {'integer', 'scalar'}, ...
               ['Padding factor for FFTs (-1= no padding, 0 = pad ' ...
               'to next power of 2, 1 = pad to power of two after, etc.).']),  ...   
            'fPassBand', ...
               getRules([0 signal.srate/2], {'numeric'}, ...
               {'nonnegative', 'row', 'size', [1, 2], '&lt;=', signal.srate/2}, ...
               'Frequency band used (default [0, Fs/2])'),  ...
            'maximumIterations', ...
               getRules(10,  ...
               {'numeric'}, {'positive', 'scalar'}, ...
               ['Maximum number of times the cleaning process ' ...
               'applied to remove line noise.']) ...
</code></pre>

<h3>
<a id="prep-as-an-eeglab-plugin" class="anchor" href="#prep-as-an-eeglab-plugin" aria-hidden="true"><span class="octicon octicon-link"></span></a>PREP as an EEGLAB plugin</h3>

<p>You can install PREP as an EEGLAB plugin by unzipping the ...  </p>

<h2>
<a id="running-the-prep-pipeline" class="anchor" href="#running-the-prep-pipeline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running the PREP pipeline</h2>

<p>Load an EEG dataset to be processed using the Load dataset submenu under the File menu of EEGLAB.  The PREP pipeline 
can be found under the Tools submenu:<br>
<img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepFromEEGLAB.png" alt="PREP from EEGLAB">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepMainMenu.png" alt="PREP main menu for EEGLAB plugin">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepBoundaryParameters.png" alt="PREP boundary menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepDetrendParameters.png" alt="PREP detrend menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepLineNoiseParameters.png" alt="PREP line noise menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepReferenceParameters.png" alt="PREP reference menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepResampleParameters.png" alt="PREP resample menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepReportParameters.png" alt="PREP report menu">  </p>

<p><img src="https://raw.githubusercontent.com/VisLab/EEG-Clean-Tools/gh-pages/images/PrepPostProcess.png" alt="PREP post process menu">  </p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/VisLab/EEG-Clean-Tools">PREP Pipeline: EEG-Clean-Tools</a> is maintained by <a href="https://github.com/VisLab">VisLab</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-66346771-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
